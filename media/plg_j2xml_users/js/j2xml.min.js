(function(){var a=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"];console=window.console=window.console||{};a.forEach(function(b){if(!console[b]){console[b]=function(){}}})}());if(typeof(eshiol)==="undefined"){eshiol={}}if(typeof(eshiol.j2xml)==="undefined"){eshiol.j2xml={}}if(typeof(eshiol.j2xml.convert)==="undefined"){eshiol.j2xml.convert=[]}eshiol.j2xml.users={};eshiol.j2xml.users.version="3.7.9";eshiol.j2xml.users.requires="19.2.323";console.log("J2XML - Users Importer v"+eshiol.j2xml.users.version);eshiol.j2xml.convert.push(function(g){console.log("eshiol.j2xml.convert.users");if(versionCompare(eshiol.j2xml.version,eshiol.j2xml.users.requires)<0){eshiol.renderMessages({error:["J2XML - Users Importer v"+eshiol.j2xml.users.version+" requires J2XML v3.7.192"]});return false}console.log(g);var d=CSVToArray(g,",");var f=d[0];console.log(f);var k=[];for(var e=0;e<f.length;e++){console.log(f[e]+": "+e);if((f[e]=="group")||(f[e].substring(0,6)=="group.")){if(typeof k.group==="undefined"){k.group=[]}k.group.push(e)}else{if(f[e].substring(0,6)=="field."){if(typeof k.fields==="undefined"){k.fields=[]}k.fields[f[e].substring(6)]=e}else{if(f[e].substring(0,8)=="profile."){if(typeof k.profiles==="undefined"){k.profiles=[]}k.profiles[f[e].substring(8)]=e}else{k[f[e]]=e}}}}Object.keys(k).forEach(function(j,i){if(Array.isArray(this[j])){Object.keys(this[j]).forEach(function(o,n){console.log(j+"."+o+": "+this[o])},this[j])}else{console.log(j+": "+this[j])}},k);if((k.username==undefined)||(k.name==undefined)||(k.email==undefined)){console.log("invalid CSV file");return g}g="";for(var e=1;e<d.length;e++){console.log(d[e]);var l="";l+="\t<user>\n";l+="\t\t<id>0</id>\n";l+="\t\t<name><![CDATA["+d[e][k.name]+"]]></name>\n";l+="\t\t<username><![CDATA["+d[e][k.username]+"]]></username>\n";l+="\t\t<email><![CDATA["+d[e][k.email]+"]]></email>\n";if((k.password!=undefined)&&(d[e][k.password]!=undefined)){l+="\t\t<password><![CDATA["+d[e][k.password]+"]]></password>\n"}else{if((k.password_clear!=undefined)&&(d[e][k.password_clear]!=undefined)){l+="\t\t<password_clear><![CDATA["+d[e][k.password_clear]+"]]></password_clear>\n"}else{password_clear=Math.random().toString(36).slice(-8);l+="\t\t<password_clear><![CDATA["+password_clear+"]]></password_clear>\n"}}l+="\t\t<requireReset>";if(k.requireReset!=undefined){l+=eshiol.j2xml.users.requireReset}else{if(k.requireReset==null){l+=eshiol.j2xml.users.requireReset}else{if(k.requireReset==0){l+=0}else{if(k.requireReset==1){l+=1}else{l+=eshiol.j2xml.users.requireReset}}}}l+="</requireReset>\n";l+="\t\t<block>0</block>\n";l+="\t\t<sendEmail>0</sendEmail>\n";l+="\t\t<registerDate><![CDATA["+(new Date().toString())+"]]></registerDate>\n";l+="\t\t<lastvisitDate><![CDATA[0000-00-00 00:00:00]]></lastvisitDate>\n";l+="\t\t<activation/>\n";l+='\t\t<params><![CDATA[{"admin_style":"","admin_language":"","language":"","editor":"","helpsite":"","timezone":""}]]></params>\n';l+="\t\t<lastResetTime><![CDATA[0000-00-00 00:00:00]]></lastResetTime>\n";l+="\t\t<resetCount>0</resetCount>\n";l+="\t\t<otpKey/>\n";l+="\t\t<otep/>\n";var b=[];if(k.groups!==undefined){JSON.parse(d[e][k.groups]).forEach(function(i){if(Array.isArray(i)){b.push(JSON.stringify(i))}else{b.push(i)}})}if(k.group!==undefined){for(var c=0;c<k.group.length;c++){b.push(d[e][k.group[c]])}}b=(function(i){var j={};return i.filter(function(n){return j.hasOwnProperty(n)?false:(j[n]=true)})})(b);if(b.length==1){l+="\t<group><![CDATA["+b[0]+"]]></group>\n"}else{if(b.length>1){l+="\t\t<grouplist>\n";b.forEach(function(i){l+="\t\t\t<group><![CDATA["+i+"]]></group>\n"});l+="\t\t</grouplist>\n"}}var h=[];if(k.fields!==undefined){Object.keys(k.fields).forEach(function(j,i){h[j]=d[e][this[j]]},k.fields)}var a=Object.keys(h).length;if(a==1){Object.keys(k.fields).forEach(function(j,i){l+="\t\t<field>\n";l+='\t\t\t<name><![CDATA[["'+j+'"]]]></name>\n';l+='\t\t\t<value><![CDATA[["'+this[j]+'"]]]></value>\n';l+="\t\t</field>\n"},h)}else{if(a>1){l+="\t\t<fieldlist>\n";Object.keys(k.fields).forEach(function(j,i){l+="\t\t\t<field>\n";l+='\t\t\t\t<name><![CDATA[["'+j+'"]]]></name>\n';l+='\t\t\t\t<value><![CDATA[["'+this[j]+'"]]]></value>\n';l+="\t\t\t</field>\n"},h);l+="\t\t</fieldlist>\n"}}var m=[];if(k.profiles!==undefined){Object.keys(k.profiles).forEach(function(j,i){m[j]=d[e][this[j]]},k.profiles)}var a=Object.keys(m).length;if(a==1){Object.keys(k.profiles).forEach(function(j,i){l+="\t\t<profile>\n";l+='\t\t\t<name><![CDATA[["'+j+'"]]]></name>\n';l+='\t\t\t<value><![CDATA[["'+this[j]+'"]]]></value>\n';l+="\t\t</profile>\n"},m)}else{if(a>1){l+="\t\t<profilelist>\n";Object.keys(k.profiles).forEach(function(j,i){l+="\t\t\t<profile>\n";l+='\t\t\t\t<name><![CDATA[["'+j+'"]]]></name>\n';l+='\t\t\t\t<value><![CDATA[["'+this[j]+'"]]]></value>\n';l+="\t\t\t</profile>\n"},m);l+="\t\t</profilelist>\n"}}l+="\t</user>\n";g+=l}return'<?xml version="1.0" encoding="UTF-8"?>\n<j2xml version="19.2.0">\n'+g+"</j2xml>"});